# W12D2 系统笔记 —— 王浩然

"Snoopy Cache" 是一种缓存一致性协议，通常用于多处理器系统中，确保不同处理器之间的缓存数据保持一致。这样，当一个处理器修改内存中的数据时，其他处理器的缓存就会被及时更新。

Snoopy Cache 协议的工作原理类似于一个"窥探"（snooping）系统，其中每个缓存都能够监视其他缓存的操作。当一个处理器对内存进行写入时，与之相连的缓存控制器会发送消息通知其他处理器，使它们的缓存失效或进行更新，以确保数据的一致性。

常见的 Snoopy Cache 协议包括 MESI（Modified, Exclusive, Shared, Invalid）协议和 MOESI（Modified, Owned, Exclusive, Shared, Invalid）协议等。这些协议定义了不同缓存状态（比如“修改”、“独占”、“共享”、“失效”等），以及在这些状态之间进行转换的规则。

## Snoopy Protocols:

Write Invalidate Protocol

Write Broadcast Protocol

Write serialization

## MESI

MESI (Modified, Exclusive, Shared, Invalid) 是一种缓存一致性协议。MESI 协议是处理多处理器系统中缓存一致性的一种方法。下面是 MESI 协议中各状态的简要说明：

1. **Modified (M)：** 表示缓存行中的数据已被修改，并且该缓存是唯一持有该数据的缓存。其他处理器的缓存中可能存在过时的数据。

2. **Exclusive (E)：** 表示缓存行中的数据与主存中的数据一致，且该缓存是唯一持有该数据的缓存。没有其他缓存拥有相同的数据。

3. **Shared (S)：** 表示缓存行中的数据与主存中的数据一致，并且可能被其他缓存共享。其他缓存也可以具有相同的数据。

4. **Invalid (I)：** 表示缓存行中的数据无效或者过时，需要从主存中重新加载。其他缓存可能拥有更新的数据。

MESI 协议的工作原理是根据读写操作来更新缓存的状态。当一个处理器执行写操作时，它会将缓存行标记为 Modified，表示它独占这个数据，并且需要将任何其他缓存中相同数据的副本标记为 Invalid。当一个处理器执行读操作时，它可以将缓存行标记为 Exclusive 或 Shared，具体取决于其他缓存是否也有相同的数据。

这种协议有助于确保多处理器系统中的缓存一致性，以防止不同处理器之间出现对同一数据的不一致操作。