# Tomasulo
## Background

Tomasulo算法是为了解决传统五级流水线中存在的结构冲突、数据冲突和控制冲突等问题而提出的。五级流水线虽然提高了指令的并行度，但在面临数据相关性和流水线阻塞时，性能受到了限制。Tomasulo算法的提出旨在克服这些局限，通过动态调度和乱序执行的方式提高指令的并行度，以进一步提高处理器的性能。

## Rename

Tomasulo算法引入了重命名寄存器（Register Renaming）和保留站（Reservation Stations）的概念，以解决数据冲突。通过使用重命名寄存器，指令不再直接使用物理寄存器，而是使用保留站中的标记（tag）来标识数据。这样，即使多条指令需要访问相同的物理寄存器，也不会产生数据冲突。保留站中的数据来源可以是寄存器、内存或其他保留站的输出。

## 执行流程

Tomasulo算法的执行流程主要包括以下步骤：

1. **发射（Issue）：** 指令从指令缓存进入执行阶段。在发射阶段，指令被分配到可用的保留站，并为其分配重命名寄存器。如果保留站不可用，指令将等待直到有可用的保留站。

2. **执行（Execute）：** 一旦指令的操作数就绪，它就会进入执行阶段。在执行阶段，指令使用重命名的寄存器执行运算，并将结果存储在保留站中。

3. **写回（Write Back）：** 一旦指令的执行完成，结果将被写回到保留站中。其他等待该结果的指令将得到通知，表明数据已经就绪。

4. **提交（Commit）：** 当指令的结果被写回到重命名寄存器中，该指令被标记为已提交。这时，结果被传送到物理寄存器文件，以供后续指令使用。

通过这种方式，Tomasulo算法实现了乱序执行和动态调度，使得处理器能够更好地处理数据相关性，提高指令级并行度，从而进一步提高计算机系统的性能。